-- 对应seata_order数据库
CREATE TABLE tbl_order(
    id             INT(11)      NOT NULL  AUTO_INCREMENT  PRIMARY KEY,
    order_no       VARCHAR(255) DEFAULT NULL,
    user_id        VARCHAR(255) DEFAULT NULL,
    product_code   VARCHAR(255) DEFAULT NULL,
    COUNT          INT(11)      DEFAULT 0,
    amount         INT(11)      DEFAULT 0
) ENGINE = INNODB DEFAULT CHARSET = utf8;


-- 对应seata_repo数据库
CREATE TABLE tbl_repo (
    id            INT(11)         NOT NULL AUTO_INCREMENT   PRIMARY KEY,
    product_code  VARCHAR(255)    DEFAULT NULL   UNIQUE,
    NAME          VARCHAR(255)    DEFAULT NULL,
    COUNT         INT(11)         DEFAULT 0
) ENGINE = INNODB DEFAULT CHARSET = utf8;

--初始化数据
INSERT INTO tbl_repo VALUES(1, 'GP2020020201', '键盘', '1000') ;
INSERT INTO tbl_repo VALUES(2, 'GP2020020202', '抱枕', '300') ;

--对应seata_acount数据库
CREATE TABLE tbl_account (
    id              INT(11)          NOT NULL AUTO_INCREMENT  PRIMARY KEY,
    user_id         VARCHAR(255)     DEFAULT NULL,
    balance         INT(11)          DEFAULT 0
) ENGINE = INNODB DEFAULT CHARSET = utf8;

-- 初始化数据
INSERT INTO tbl_account VALUES(1, '1001', '10000.00') ;


-- seata使用
CREATE TABLE undo_log(
    id               BIGINT(20)        NOT NULL       AUTO_INCREMENT   PRIMARY KEY,
    branch_id        BIGINT(20)        NOT NULL,
    xid              VARCHAR(20)       NOT NULL,
    context          VARCHAR(128)      NOT NULL,
    rollback_info    LONGBLOB          NOT NULL,
    log_status       INT(11)           NOT NULL,
    log_created      DATETIME          NOT NULL,
    log_modified     DATETIME          NOT NULL,
    UNIQUE KEY ux_undo_log(xid,branch_id)
)  ENGINE = INNODB DEFAULT CHARSET = utf8;